order: 1
id: powerpoint-basics-basic-api-call-ts
name: Basic API call (TypeScript)
description: Performs a basic PowerPoint API call using TypeScript.
host: POWERPOINT
api_set:
    PowerPointApi: '1.4'
script:
    content: |
        $("#run").on("click", () => tryCatch(run));

        const run: Function = async () => {
          // This function gets the collection of shapes on the first slide,
          // and adds a text box to the collection, while specifying its text,
          // location, and size. Then it names the text box.
          await PowerPoint.run(async (context) => {
            const shapes: PowerPoint.ShapeCollection = context.presentation.slides.getItemAt(0).shapes;
            const shapeOptions: PowerPoint.ShapeAddOptions = {
              left: 100,
              top: 300,
              height: 300,
              width: 450
            };
            const textbox: PowerPoint.Shape = shapes.addTextBox("Hello!", shapeOptions);

            await context.sync();
          });
        }

        /** Default helper for invoking an action and handling errors. */
        const tryCatch: (callback: Function) => void = async (callback: Function) => {
          try {
            await callback();
          } catch (error) {
            // Note: In a production add-in, you'd want to notify the user through your add-in's UI.
            console.error(error);
          }
        }
    language: typescript
template:
    content: |-
        <section class="ms-Fabric ms-font-m">
            This sample executes a code snippet that adds a text box to the first slide in the presentation.
        </section>
        <button id="run" class="ms-Button">
            <span class="ms-Button-label">Add text box</span>
        </button>
    language: html
style:
    content: |-
        section.samples {
            margin-top: 20px;
        }

        section.samples .ms-Button, section.setup .ms-Button {
            display: block;
            margin-bottom: 5px;
            margin-left: 20px;
            min-width: 80px;
        }
    language: css
libraries: |
    https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js
    @types/office-js

    office-ui-fabric-core@11.1.0/dist/css/fabric.min.css
    office-ui-fabric-js@1.5.0/dist/css/fabric.components.min.css

    core-js@2.4.1/client/core.min.js
    @types/core-js

    jquery@3.1.1
    @types/jquery@3.3.1