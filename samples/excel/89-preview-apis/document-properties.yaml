order: 6
id: excel-document-properties
name: Document properties
description: Get and set document properties.
host: EXCEL
api_set:
    ExcelApi: 1.7
script:
    content: |+
        $("#get-doc-properties").click(() => tryCatch(getDocProperties));
        $("#set-get-doc-properties").click(() => tryCatch(setGetDocProperties));

        async function getDocProperties() {
            await Excel.run(async (context) => {
                let getProperties = context.workbook.properties;

                // Load the read-only document properties.
                getProperties.load("author, lastauthor, revisionnumber, creationdate");

                await context.sync();

                console.log("Author  :" + getProperties.author);
                console.log("Last author  : " + getProperties.lastAuthor);
                console.log("Revision number : " + getProperties.revisionNumber);
              
                OfficeHelpers.UI.notify("Workbook creation date : " + getProperties.creationDate.toDateString());            
            });
        }

        async function setGetDocProperties() {
            await Excel.run(async (context) => {
                let titleValue = "Excel document properties API";
                let subjectValue = "Set and get document properties";
                let keywordsValue = "Set and get operations";
                let commentsValue = "This is an Excel document properties API code sample";
                let categoryValue = "Office Add-ins";
                let managerValue = "John";
                let companyValue = "Microsoft";

                let setProperties = context.workbook.properties;

                // Set the docoment properties.
                setProperties.title = titleValue;
                setProperties.subject = subjectValue;
                setProperties.keywords = keywordsValue;
                setProperties.comments = commentsValue;
                setProperties.category = categoryValue;
                setProperties.manager = managerValue;
                setProperties.company = companyValue;
                
                let propertiesToGet = context.workbook.properties;

                await context.sync();
                
                // Get the docoment properties.
                console.log("Title :" + propertiesToGet.title);  
                console.log("Keywords :" + propertiesToGet.keywords);
                console.log("Comments :" + propertiesToGet.comments);
                console.log("Category :" + propertiesToGet.category);
                console.log("Manager :" + propertiesToGet.manager);
                console.log("Company :" + propertiesToGet.company); 
                
                OfficeHelpers.UI.notify(propertiesToGet.subject);            
            });
        }

        /** Default helper for invoking an action and handling errors. */
        async function tryCatch(callback) {
            try {
                await callback();
            }
            catch (error) {
                OfficeHelpers.UI.notify(error);
                OfficeHelpers.Utilities.log(error);
            }
        }



    language: typescript
template:
    content: |+
        <section class="ms-font-m">
            <p>This sample shows how to get and set document properties.</p>
        </section>

        <section class="samples ms-font-m">
            <h3>Try it out</h3>
            <button id="get-doc-properties" class="ms-Button">
                <span class="ms-Button-label">Get document properties</span>
            </button>
        </section>

        <section class="samples ms-font-m">
            <button id="set-get-doc-properties" class="ms-Button">
                <span class="ms-Button-label">Set and get document properties</span>
            </button>
        </section>

    language: html
style:
    content: "section.samples {\r\n    margin-top: 20px;\r\n}\r\n\r\nsection.samples .ms-Button, section.setup .ms-Button {\r\n    display: block;\r\n    margin-bottom: 5px;\r\n    margin-left: 20px;\r\n    min-width: 80px;\r\n}\r\n"
    language: css
libraries: |4
        https://appsforoffice.microsoft.com/lib/beta/hosted/office.js
        https://appsforoffice.microsoft.com/lib/beta/hosted/office.d.ts

        office-ui-fabric-js@1.4.0/dist/css/fabric.min.css
        office-ui-fabric-js@1.4.0/dist/css/fabric.components.min.css

        core-js@2.4.1/client/core.min.js
        @types/core-js

        @microsoft/office-js-helpers@0.7.4/dist/office.helpers.min.js
        @microsoft/office-js-helpers@0.7.4/dist/office.helpers.d.ts

        jquery@3.1.1
        @types/jquery