id: cj0a1ls790000386wlkj0weit
gist: ''
host: EXCEL
api_set: {}
platform: null
created_at: 1489526470210
modified_at: 1489532178811
origin: 'https://bornholm-edge.azurewebsites.net'
author: Microsoft
name: API call with Fabric notification toast
description: >-
  Highlights the currently-selected range and reports its address via Fabric
  Message Banner
script:
  content: |
    declare var fabric: any;

    $("#run").click(run);

    /**
     * This sample will color the selected range in yellow,
     * and also display the selection address.
     */
    async function run() {
        try {
            await Excel.run(async (context) => {
                let range = context.workbook.getSelectedRange();
                range.format.fill.color = "yellow";
                range.load("address");
                await context.sync();
                showNotification(`The selection address is "${range.address}".`);
            });
        }
        catch (error) {
            showNotification(error.message || error.toString());
            OfficeHelpers.Utilities.log(error);
        }
    }

    /**
     * Display the notification having synced the changes.
     */
    function showNotification(message: string) {
        const messageBanner = $('.ms-MessageBanner');
        $('.ms-MessageBanner-clipper').text(message);
        $('.ms-MessageBanner-close').click(() => {
            messageBanner.hide();
            messageBanner.off('click');
        });
        messageBanner.show();
    }
  language: typescript
style:
  content: |
    /* Overriding Fabric styles */
    .ms-Button, .ms-Button:focus {
        background: #217346;
        border: #217346;
    }

    .ms-Button > .ms-Button-label,
    .ms-Button:focus > .ms-Button-label,
    .ms-Button:hover > .ms-Button-label {
        color: white;
    }

    .ms-Button:hover, .ms-Button:active {
        background: #164b2e;
    }

    .ms-Button.is-disabled, .ms-Button:disabled {
        background-color: #f4f4f4;
        border-color: #f4f4f4;
    }

    .ms-Button.is-disabled .ms-Button-label,
    .ms-Button:disabled .ms-Button-label {
        color: #a6a6a6;
    }

    .ms-MessageBanner {
        display: none;
    }
  language: css
template:
  content: >
    <!-- Fabric Message Banner template -->

    <!--
    https://dev.office.com/fabric-js/Components/MessageBanner/MessageBanner.html
    -->

    <div class="ms-MessageBanner">
      <div class="ms-MessageBanner-content">
        <div class="ms-MessageBanner-text">
          <div class="ms-MessageBanner-clipper"></div>
        </div>
        <button class="ms-MessageBanner-expand">
          <i class="ms-Icon ms-Icon--ChevronDown"></i>
        </button>
      </div>
      <button class="ms-MessageBanner-close">
        <i class="ms-Icon ms-Icon--Clear"></i>
      </button>
    </div>


    <section class="ms-font-m">
        <h1 class="ms-font-xl">A snippet with a notification toast</h1>
        <p class="ms-font-m">This sample will color the selected range in yellow, and also display the selection address in a notification toast.</p>
        <button id="run" class="ms-Button">
            <span class="ms-Button-label">Run code</span>
        </button>
    </section>
  language: html
libraries: |
  # Office.js
  https://appsforoffice.officeapps.live.com/afo/lib/beta/hosted/office.js

  # CSS Libraries
  office-ui-fabric-js@1.4.0/dist/css/fabric.min.css
  office-ui-fabric-js@1.4.0/dist/css/fabric.components.min.css

  # NPM libraries
  core-js@2.4.1/client/core.min.js
  @microsoft/office-js-helpers@0.5.0/dist/office.helpers.min.js
  jquery@3.1.1

  # IntelliSense: @types/library or node_modules paths or URL to d.ts files
  @types/office-js
  @types/core-js
  @microsoft/office-js-helpers/dist/office.helpers.d.ts
  @types/jquery
