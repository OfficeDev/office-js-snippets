order: 3
id: word-shapes-group-ungroup
name: Group and ungroup shapes
description: Shows how to group and ungroup shapes.
host: WORD
api_set:
    WordApiDesktop: '1.2'
script:
    content: |
        document.getElementById("group-shapes").addEventListener("click", () => tryCatch(groupShapes));
        document.getElementById("move-group").addEventListener("click", () => tryCatch(moveGroup));
        document.getElementById("scale-group").addEventListener("click", () => tryCatch(scaleGroup));
        document.getElementById("change-group-position").addEventListener("click", () => tryCatch(changeGroupPosition));
        document.getElementById("change-group-size").addEventListener("click", () => tryCatch(changeGroupSize));
        document.getElementById("ungroup-shapes").addEventListener("click", () => tryCatch(ungroupShapes));
        document.getElementById("setup").addEventListener("click", () => tryCatch(setup));

        async function groupShapes() {
          await Word.run(async (context) => {
            // Groups the shapes (including text boxes and pictures) found in the document body.
            const shapes: Word.ShapeCollection = context.document.body.shapes.getByTypes([
              Word.ShapeType.geometricShape,
              Word.ShapeType.textBox,
              Word.ShapeType.picture,
            ]);
            shapes.load("items");
            await context.sync();

            const numShapes = shapes.items.length;
            if (numShapes === 0) {
              console.log("No shapes found in the document body.");
              return;
            }

            console.log(`Number of shapes to group: ${numShapes}`);

            const groupedShape: Word.Shape = shapes.group();
            groupedShape.load("shapeGroup/shapes");
            await context.sync();

            const shapeGroup: Word.ShapeGroup = groupedShape.shapeGroup;
            console.log("Shapes grouped:", shapeGroup.shapes);
            groupedShape.select();
          });
        }

        async function moveGroup() {
          await Word.run(async (context) => {
            // Moves the first set of grouped shapes (including text boxes) found in the document body.
            const firstShapeGroup: Word.Shape = context.document.body.shapes
              .getByTypes([Word.ShapeType.group])
              .getFirstOrNullObject();
            firstShapeGroup.load("shapeGroup/shapes");
            await context.sync();

            if (firstShapeGroup.isNullObject) {
              console.log("No shape groups found in the document body.");
              return;
            }

            let shapeGroup: Word.ShapeGroup = firstShapeGroup.shapeGroup;
            console.log("About to move the first shape group found in the document body:", shapeGroup.shapes);
            firstShapeGroup.moveHorizontally(-10);
            firstShapeGroup.moveVertically(50);

            console.log("Moved the first shape group.");
          });
        }

        async function scaleGroup() {
          await Word.run(async (context) => {
            // Scales the first set of grouped shapes (including text boxes) found in the document body.
            const firstShapeGroup: Word.Shape = context.document.body.shapes
              .getByTypes([Word.ShapeType.group])
              .getFirstOrNullObject();
            firstShapeGroup.load("shapeGroup/shapes");
            await context.sync();

            if (firstShapeGroup.isNullObject) {
              console.log("No shape groups found in the document body.");
              return;
            }

            let shapeGroup: Word.ShapeGroup = firstShapeGroup.shapeGroup;
            console.log("About to scale the first shape group found in the document body:", shapeGroup.shapes);
            firstShapeGroup.scaleHeight(0.75, Word.ShapeScaleType.currentSize);
            firstShapeGroup.scaleWidth(0.5, Word.ShapeScaleType.currentSize, Word.ShapeScaleFrom.scaleFromBottomRight);

            console.log("Scaled the first shape group.");
          });
        }

        async function changeGroupPosition() {
          await Word.run(async (context) => {
            // Changes the position of the first set of grouped shapes (including text boxes) found in the document body.
            const firstShapeGroup: Word.Shape = context.document.body.shapes
              .getByTypes([Word.ShapeType.group])
              .getFirstOrNullObject();
            firstShapeGroup.load("shapeGroup/shapes");
            await context.sync();

            if (firstShapeGroup.isNullObject) {
              console.log("No shape groups found in the document body.");
              return;
            }

            let shapeGroup: Word.ShapeGroup = firstShapeGroup.shapeGroup;
            console.log("About to change the position of the first shape group found in document body:", shapeGroup.shapes);
            firstShapeGroup.relativeVerticalPosition = Word.RelativeVerticalPosition.insideMargin;
            firstShapeGroup.relativeHorizontalPosition = Word.RelativeHorizontalPosition.margin;

            console.log("Changed the position of the first shape group.");
          });
        }

        async function changeGroupSize() {
          await Word.run(async (context) => {
            // Changes the relative size of the first set of grouped shapes (including text boxes) found in the document body.
            const firstShapeGroup: Word.Shape = context.document.body.shapes
              .getByTypes([Word.ShapeType.group])
              .getFirstOrNullObject();
            firstShapeGroup.load("shapeGroup/shapes");
            await context.sync();

            if (firstShapeGroup.isNullObject) {
              console.log("No shape groups found in the document body.");
              return;
            }

            let shapeGroup: Word.ShapeGroup = firstShapeGroup.shapeGroup;
            console.log(
              "About to change the relative size of the first shape group found in the document body:",
              shapeGroup.shapes,
            );
            firstShapeGroup.relativeHorizontalSize = Word.RelativeSize.insideMargin;
            firstShapeGroup.relativeVerticalSize = Word.RelativeSize.bottomMargin;
            firstShapeGroup.heightRelative = 50;

            console.log("Changed the relative size of the first shape group.");
          });
        }

        async function ungroupShapes() {
          await Word.run(async (context) => {
            // Ungroups the first set of grouped shapes (including text boxes) found in the document body.
            const firstShapeGroup: Word.Shape = context.document.body.shapes
              .getByTypes([Word.ShapeType.group])
              .getFirstOrNullObject();
            firstShapeGroup.load("shapeGroup/shapes");
            await context.sync();

            if (firstShapeGroup.isNullObject) {
              console.log("No shape groups found in the document body.");
              return;
            }

            let shapeGroup: Word.ShapeGroup = firstShapeGroup.shapeGroup;
            console.log("About to ungroup the first shape group found in the document body:", shapeGroup.shapes);
            shapeGroup.ungroup();

            console.log("Ungrouped the first shape group.");
          });
        }

        async function setup() {
          await Word.run(async (context) => {
            const body: Word.Body = context.document.body;
            body.clear();
            const lastParagraph: Word.Paragraph = body.paragraphs.getLast();

            // Inserts a text box.
            const textBoxOptions: Word.InsertShapeOptions = {
              top: 0,
              left: 0,
              height: 100,
              width: 100,
            };
            lastParagraph.insertTextBox("placeholder text", textBoxOptions);

            // Inserts a geometric shape.
            const geometricShapeOptions: Word.InsertShapeOptions = {
              height: 120,
              width: 120,
              left: 120,
            };
            lastParagraph.insertGeometricShape(Word.GeometricShapeType.star24, geometricShapeOptions);

            // Inserts a picture.
            const pictureOptions: Word.InsertShapeOptions = {
              top: 120,
              left: 60,
              height: 150,
              width: 150,
            };
            lastParagraph.insertPictureFromBase64(getPictureBase64(), pictureOptions);

            await context.sync();
          });
        }

        function getPictureBase64(): string {
          // Returns Base64-encoded image data for a sample picture.
          const pictureBase64 =
            "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";
          return pictureBase64;
        }

        // Default helper for invoking an action and handling errors.
        async function tryCatch(callback) {
          try {
            await callback();
          } catch (error) {
            // Note: In a production add-in, you'd want to notify the user through your add-in's UI.
            console.error(error);
          }
        }
    language: typescript
template:
    content: |-
        <section>
            This sample demonstrates how to group and ungroup shapes.
        </section>
        <section class="setup">
            <h3>Set up</h3>
            <button id="setup">Add shapes</button>
        </section>
        <section>
            <h3>Try it out</h3>
            <button id="group-shapes">Group shapes</button>
            <button id="move-group">Move group</button>
            <button id="scale-group">Scale group</button>
            <button id="change-group-position">Change group position</button>
            <button id="change-group-size">Change group size</button>
            <button id="ungroup-shapes">Ungroup shapes</button>
        </section>
    language: html
style:
    content: |-
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            padding: 10px;
        }

        section {
            margin-bottom: 20px;
        }

        h3 {
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 16px;
        }

        p {
            margin: 0 0 10px 0;
        }

        button {
            background-color: #f0f0f0;
            color: #333333;
            border: 1px solid #8a8a8a;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 2px;
            margin-left: 20px;
            margin-bottom: 5px;
            min-width: 80px;
            display: block;
        }

        button:hover {
            background-color: #e0e0e0;
        }

        button:active {
            background-color: #d0d0d0;
        }

        input {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 2px;
            font-size: 14px;
        }

        .header {
            text-align: center;
            background-color: #f3f2f1;
            padding: 10px;
        }
    language: css
libraries: |-
    https://appsforoffice.microsoft.com/lib/1/hosted/office.js
    https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts