name: Column and Row Sort Events
description: >-
  Registers event handlers that run when column or row events occur in the
  current worksheet.
host: EXCEL
api_set: {}
script:
  content: |
    $("#register-sort-handler").click(() => tryCatch(registerSortHandler));

    async function registerSortHandler() {
        await Excel.run(async (context) => {
            const sheet = context.workbook.worksheets.getActiveWorksheet();
            sheet.onRowSorted.add((event) => {
                return Excel.run((context) => {
                    // TODO
                    return context.sync();
                });
            });

            sheet.onColumnSorted.add((event) => {
                return Excel.run((context) => {
                    // TODO
                    return context.sync();
                });
            });
        });
    }

    /** Default helper for invoking an action and handling errors. */
    async function tryCatch(callback) {
        try {
            await callback();
        } catch (error) {
            // Note: In a production add-in, you'd want to notify the user through your add-in's UI.
            console.error(error);
        }
    }
  language: typescript
template:
  content: |-
    <section class="ms-font-m">
      <p>This sample shows how to register and use handlers for the column and row sorted events.</p>
    </section>

    <section class="samples ms-font-m">
      <h3>Try it out</h3>
      <button id="register-sort-handlers" class="ms-Button">
        <span class="ms-Button-label">Register event handlers</span>
      </button>
    </section>
  language: html
style:
  content: |-
    section.samples {
        margin-top: 20px;
    }

    section.samples .ms-Button, section.setup .ms-Button {
        display: block;
        margin-bottom: 5px;
        margin-left: 20px;
        min-width: 80px;
    }
  language: css
libraries: |
  https://appsforoffice.microsoft.com/lib/beta/hosted/office.js
  @types/office-js-preview

  office-ui-fabric-js@1.4.0/dist/css/fabric.min.css
  office-ui-fabric-js@1.4.0/dist/css/fabric.components.min.css

  core-js@2.4.1/client/core.min.js
  @types/core-js

  jquery@3.1.1
  @types/jquery@3.3.1
