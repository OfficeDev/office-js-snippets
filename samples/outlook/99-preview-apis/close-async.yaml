order: 3
id: outlook-close-async
name: Close the current item and discard changes
description: Close the current item and discard the changes when specified.
host: OUTLOOK
api_set:
    Mailbox: preview
script:
    content: |
        $("#closeAsync").click(closeAsync);

        function closeAsync() {
          // This snippet closes and discards the current item. This api call works on new compose messages and existing drafts when the optional parameter, discardItem, is set to true. When set to false, on new compose messages, the user is prompted to either save or discard the changes or cancel the close operation

          Office.context.mailbox.item.closeAsync(
            { discardItem: true },
            (asyncResult) => {
              if (asyncResult.status === Office.AsyncResultStatus.Failed) {
                console.log("Action failed with error: " + asyncResult.error.message);
                return;
              }
            });
        }
    language: typescript
template:
    content: |
        <button id="run" class="ms-Button">
            <span class="ms-Button-label">Run</span>
        </button>
    language: html
style:
    content: |-
        section.samples {
            margin-top: 20px;
        }

        section.samples .ms-Button, section.setup .ms-Button {
            display: block;
            margin-bottom: 5px;
            margin-left: 20px;
            min-width: 80px;
        }
    language: css
libraries: |
    https://appsforoffice.microsoft.com/lib/1/hosted/office.js
    @types/office-js

    office-ui-fabric-js@1.4.0/dist/css/fabric.min.css
    office-ui-fabric-js@1.4.0/dist/css/fabric.components.min.css

    core-js@2.4.1/client/core.min.js
    @types/core-js

    jquery@3.1.1
    @types/jquery@3.3.1