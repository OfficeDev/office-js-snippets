id: outlook-mime-headers-manage-custom-internet-headers-message-compose
name: Work with custom internet headers
description: Sets, gets, and removes custom internet headers on a message in Compose mode.
host: OUTLOOK
api_set:
    Mailbox: '1.8'
script:
    content: |-
        document.getElementById("set-custom-headers").addEventListener("click", setCustomHeaders);
        document.getElementById("get-selected-custom-headers").addEventListener("click", getSelectedCustomHeaders);
        document.getElementById("remove-selected-custom-headers").addEventListener("click", removeSelectedCustomHeaders);

        // Set custom internet headers.
        function setCustomHeaders() {
          Office.context.mailbox.item.internetHeaders.setAsync(
            { "preferred-fruit": "orange", "preferred-vegetable": "broccoli", "best-vegetable": "spinach" },
            function (asyncResult) {
              if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {
                console.log("Successfully set headers");
              } else {
                console.log("Error setting headers: " + JSON.stringify(asyncResult.error));
              }
            }

          );
        }

        // Get custom internet headers.
        function getSelectedCustomHeaders() {
          Office.context.mailbox.item.internetHeaders.getAsync(
            ["preferred-fruit", "preferred-vegetable", "best-vegetable", "nonexistent-header"],
            function (asyncResult) {
              if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {
                console.log("Selected headers: " + JSON.stringify(asyncResult.value));
              } else {
                console.log("Error getting selected headers: " + JSON.stringify(asyncResult.error));
              }
            }
          );
        }

        // Remove custom internet headers.
        function removeSelectedCustomHeaders() {
          Office.context.mailbox.item.internetHeaders.removeAsync(
            ["best-vegetable", "nonexistent-header"],
            function (asyncResult) {
              if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {
                console.log("Successfully removed selected headers");
              } else {
                console.log("Error removing selected headers: " + JSON.stringify(asyncResult.error));
              }
            }
          );
        }

        /* Sample output:
        Successfully set headers
        Selected headers: {"best-vegetable":"spinach","preferred-fruit":"orange","preferred-vegetable":"broccoli"}
        Successfully removed selected headers
        Selected headers: {"preferred-fruit":"orange","preferred-vegetable":"broccoli"}
        */
    language: typescript
template:
    content: |-
        <section>
            <p>This sample shows how to set, get, and remove custom internet headers on a message in Compose mode.</p>
            <p><b>Required mode</b>: Message Compose</p>
        </section>
        <section>
            <h3>Try it out</h3>
            <button id="set-custom-headers">Set custom headers</button>
            <button id="get-selected-custom-headers">Get selected custom headers</button>
            <button id="remove-selected-custom-headers">Remove selected custom headers</button>
        </section>
    language: html
style:
    content: |-
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            padding: 10px;
        }

        section {
            margin-bottom: 20px;
        }

        h3 {
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 16px;
        }

        p {
            margin: 0 0 10px 0;
        }

        button {
            background-color: #f0f0f0;
            color: #333333;
            border: 1px solid #8a8a8a;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 2px;
            margin-left: 20px;
            margin-bottom: 5px;
            min-width: 80px;
            display: block;
        }

        button:hover {
            background-color: #e0e0e0;
        }

        button:active {
            background-color: #d0d0d0;
        }

        input {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 2px;
            font-size: 14px;
        }

        .header {
            text-align: center;
            background-color: #f3f2f1;
            padding: 10px;
        }
    language: css
libraries: |-
    https://appsforoffice.microsoft.com/lib/1/hosted/office.js
    https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts