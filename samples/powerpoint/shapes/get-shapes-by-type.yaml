order: 3
id: powerpoint-shapes-get-shapes-by-type
name: Select shapes by type
description: Gets shapes in a slide based on their type, such as GeometricShape or Line.
host: POWERPOINT
api_set:
    PowerPointApi: '1.8'
script:
    content: |
        document.getElementById("setup").addEventListener("click", () => tryCatch(setup));
        document.getElementById("change-lines").addEventListener("click", () => tryCatch(changeLines));
        document.getElementById("change-geometric-shapes").addEventListener("click", () => tryCatch(changeGeometricShapes));
        document.getElementById("get-placeholder-shapes").addEventListener("click", () => tryCatch(getPlaceholderShapes));

        async function changeLines() {
          // Changes the dash style of every line in the slide.
          await PowerPoint.run(async (context) => {
            // Get the type of shape for every shape in the collection.
            const shapes: PowerPoint.ShapeCollection = context.presentation.slides.getItemAt(0).shapes;
            shapes.load("type");
            await context.sync();

            // Change the dash style for shapes of the type `line`.
            shapes.items.forEach((shape) => {
              if (shape.type === PowerPoint.ShapeType.line) {
                shape.lineFormat.style = PowerPoint.ShapeLineStyle.thickThin;
                shape.lineFormat.dashStyle = PowerPoint.ShapeLineDashStyle.dashDot;
              }
            });
            await context.sync();
          });
        }

        async function changeGeometricShapes() {
          // Changes the transparency of every geometric shape in the slide.
          await PowerPoint.run(async (context) => {
            // Get the type of shape for every shape in the collection.
            const shapes: PowerPoint.ShapeCollection = context.presentation.slides.getItemAt(0).shapes;
            shapes.load("type");
            await context.sync();

            // Change the shape transparency to be halfway transparent.
            shapes.items.forEach((shape) => {
              if (shape.type === PowerPoint.ShapeType.geometricShape) {
                shape.fill.transparency = 0.5;
              }
            });
            await context.sync();
          });
        }

        async function getPlaceholderShapes() {
          // Gets the placeholder shapes in the slide.
          await PowerPoint.run(async (context) => {
            // Get properties for every shape in the collection.
            const shapes: PowerPoint.ShapeCollection = context.presentation.slides.getItemAt(0).shapes;
            shapes.load("type,name");
            await context.sync();

            const placeholderShapes = [];
            console.log(`Number of shapes found: ${shapes.items.length}`);
            shapes.items.forEach((shape) => {
              if (shape.type === PowerPoint.ShapeType.placeholder) {
                // Load placeholderFormat property.
                // PowerPoint throws an exception if you try to load this property on a shape that isn't a placeholder type.
                shape.load("placeholderFormat");
                placeholderShapes.push(shape);
              }
            });
            await context.sync();

            console.log(`Number of placeholder shapes found: ${placeholderShapes.length}`);
            for (let i = 0; i < placeholderShapes.length; i++) {
              let currentPlaceholder: PowerPoint.PlaceholderFormat = placeholderShapes[i].placeholderFormat;
              let placeholderType = currentPlaceholder.type as PowerPoint.PlaceholderType;
              let placeholderContainedType = currentPlaceholder.containedType as PowerPoint.ShapeType;
              console.log(`Shape "${placeholderShapes[i].name}" placeholder properties:`);
              console.log(`\ttype: ${placeholderType}`);
              console.log(`\tcontainedType: ${placeholderContainedType}`);
            }
          });
        }

        async function setup() {
          await PowerPoint.run(async (context) => {
            // Create shapes of different types.
            const shapes = context.presentation.slides.getItemAt(0).shapes;

            // Create geometric shapes.
            shapes.addGeometricShape(PowerPoint.GeometricShapeType.diamond, {
              left: 100,
              top: 100,
              height: 150,
              width: 150,
            });
            shapes.addGeometricShape(PowerPoint.GeometricShapeType.octagon, {
              left: 400,
              top: 300,
              height: 150,
              width: 150,
            });

            // Create lines.
            shapes.addLine(PowerPoint.ConnectorType.elbow, {
              left: 400,
              top: 150,
              height: 20,
              width: 150,
            });
            shapes.addLine(PowerPoint.ConnectorType.curve, {
              left: 100,
              top: 300,
              height: 150,
              width: 20,
            });

            await context.sync();
          });
        }

        /** Default helper for invoking an action and handling errors. */
        async function tryCatch(callback) {
          try {
            await callback();
          } catch (error) {
            // Note: In a production add-in, you'd want to notify the user through your add-in's UI.
            console.error(error);
          }
        }
    language: typescript
template:
    content: |-
        <section>
          <p>This sample shows how select and change shapes based on their types.</p>
        </section>
        <section>
          <h3>Setup</h3>
          <p>Create some shapes in a new, blank presentation.</p>
          <p />
          <button id="setup">Setup</button>
          <p />
          <h3>Try it out</h3>
          <p />
          <button id="change-lines">Change lines</button>
          <p />
          <button id="change-geometric-shapes">Change geometric shapes</button>
          <p />
          <button id="get-placeholder-shapes">Get placeholder shapes</button>
          <p />
        </section>
    language: html
style:
    content: |-
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            padding: 10px;
        }

        section {
            margin-bottom: 20px;
        }

        h3 {
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 16px;
        }

        p {
            margin: 0 0 10px 0;
        }

        button {
            background-color: #f0f0f0;
            color: #333333;
            border: 1px solid #8a8a8a;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 2px;
            margin-left: 20px;
            margin-bottom: 5px;
            min-width: 80px;
            display: block;
        }

        button:hover {
            background-color: #e0e0e0;
        }

        button:active {
            background-color: #d0d0d0;
        }

        input {
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 2px;
            font-size: 14px;
        }

        .header {
            text-align: center;
            background-color: #f3f2f1;
            padding: 10px;
        }
    language: css
libraries: |-
    https://appsforoffice.microsoft.com/lib/1/hosted/office.js
    https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts